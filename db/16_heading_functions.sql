CREATE OR REPLACE FUNCTION HEADING(h VARCHAR(2))
RETURNS numeric
AS $$
  SELECT CASE WHEN h = 'N' THEN 0.0 
  WHEN h = 'NE' THEN 45.0 
  WHEN h = 'E' THEN 90.0
  WHEN h = 'SE' THEN 135.0
  WHEN h = 'S' THEN 180.0
  WHEN h = 'SW' THEN 225.0
  WHEN h = 'W' THEN 270.0
  WHEN h = 'NW' THEN 315.0
  END
$$ LANGUAGE SQL;

CREATE OR REPLACE FUNCTION NORTH(heading FLOAT)
RETURNS double precision
AS $$
  SELECT SIN(heading/2/3.141592653589793)
$$ LANGUAGE SQL;

CREATE OR REPLACE FUNCTION EAST(heading FLOAT)
RETURNS double precision
AS $$
  SELECT COS(heading/2/3.141592653589793)
$$ LANGUAGE SQL;
